[{"code":"function R(e){let{premiumSubscription:t,setPurchaseState:n,onBack:a,onNext:s,legalTermsNodeRef:R,flashLegalTerms:P,invoiceError:D,planError:L,onPurchaseError:x,baseAnalyticsData:M,flowStartTime:j,trialId:k,planGroup:U,analyticsLocation:G,purchaseTokenAuthState:F,openInvoiceId:V,metadata:B,backButtonEligible:H,disablePurchase:Y,isTrial:W=!1,onPaymentSourceAdd:K}=e,{selectedPlan:z,priceOptions:q,setHasAcceptedTerms:Z,setPurchaseError:Q,purchaseType:X,paymentSourceId:J,paymentSources:$,selectedSkuId:ee,skusById:et,skuPricePreviewsById:en,referralCode:er,contextMetadata:ei,invoicePreview:ea,inReverseTrial:eo,premiumBrandRefreshBackgroundClassName:es}=(0,v.P5)(),{isGift:el,selectedGiftStyle:ec,customGiftMessage:eu,emojiConfetti:ed,soundEffect:ef,giftRecipient:ep,selectedGiftingPromotionReward:e_}=(0,O.Pv)(),eh=(0,p.Mq)(z),em=(0,y.lo)(ep),eg={};eg.gift_style=ec,eg.reward_sku_ids=eh&&null!=e_?[e_]:[],em===y.tB.CUSTOM_MESSAGE_EMOJI_SOUNDBOARD&&(l()(null!=ep,\"Gift recipient must be set at purchase review step for these gift options.\"),eg.recipient_id=ep.id,eg.custom_message=eu,eg.emoji_id=null==ed?void 0:ed.id,eg.emoji_name=(null==ed?void 0:ed.id)==null?null==ed?void 0:ed.surrogates:void 0,eg.sound_id=null==ef?void 0:ef.soundId);let eE=null==z?void 0:z.id,ey=(0,I.$o)(k,q.paymentSourceId,eE),{analyticsLocations:eb}=(0,d.Ay)(),eO=(0,T.W)($,J),[ev,eA]=i.useState(ey),[eI,eS]=i.useState(!1),{hasEntitlements:eT}=(0,m.X)(eE,el),eC=(0,b.J$)(q.paymentSourceId),eN=eT||ey,ew=(0,_.l)(),eR=(0,c.bG)([S.A],()=>S.A.currentOrderId),eP=null,eD=null;if(X===N.VVm.ONE_TIME){var eL;l()(null!=ee,\"SKU must be selected for one-time purchases\"),eP=null!=(eL=et[ee])?eL:null,l()(null!=eP,\"SKU must exist and be fetched.\");let e=en[ee],t=null!=J?J:E.B;eD=null!=e?e[t]:null}let ex=async()=>{await (0,A.l)({setPurchaseState:n,setHasAcceptedTerms:Z,setIsSubmitting:eA,setPurchaseError:Q,hasRedirectURL:eI,setHasRedirectURL:eS,isGift:el,baseAnalyticsData:M,analyticsLocation:G,analyticsLocations:eb,flowStartTime:j,subscriptionPlan:z,planGroup:U,trialId:k,priceOptions:q,paymentSource:eO,isPrepaidPaymentPastDue:ew,openInvoiceId:V,premiumSubscription:t,onNext:s,metadata:B,sku:eP,skuPricePreview:eD,purchaseType:X,referralCode:er,loadId:ei.loadId,giftInfoOptions:eg,invoicePreview:ea,orderId:eR})},eM={baseAnalyticsData:M,flowStartTime:j,makePurchase:ex,onNext:s,onPurchaseError:x,paymentSource:eO,paymentSourceId:J,purchaseTokenAuthState:F,setPurchaseState:n},ej=i.useRef(eM);i.useEffect(()=>{ej.current=eM}),i.useEffect(()=>{let{makePurchase:e}=ej.current;ey&&!el&&null==t&&e()},[ey,el,t]);let ek=null!=V||X===N.VVm.ONE_TIME&&!el,eU=H&&!ek;return ey?null:(0,r.jsxs)(u.jlY,{\"data-migration-pending\":!0,align:f.A.Align.CENTER,className:o()(es,w.H),children:[(0,r.jsx)(g.A,{legalTermsNodeRef:R,invoiceError:D,planError:L,disablePurchase:Y,flashLegalTerms:P,isSubmitting:ev,premiumSubscription:t,isGift:el,planGroup:U,isPrepaid:eC,isTrial:W,makePurchase:ex,needsPaymentSource:null==eO&&!eN,onNext:s,inReverseTrial:eo,onPaymentSourceAdd:K}),(0,r.jsx)(C.A,{}),eU?(0,r.jsx)(\"div\",{className:w.a,children:(0,r.jsx)(h.A,{onClick:a})}):null]})}"}]