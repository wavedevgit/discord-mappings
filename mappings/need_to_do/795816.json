[{"code":"async function ep(e,t,n){try{l.h.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_START\"});let r=null!=t?{channel_id:t}:void 0,i=await s.Bo.post({url:$.Rsh.APPLICATION_UPLOAD_ATTACHMENT(e),query:r,attachments:[{name:\"file\",file:n}],rejectWithError:!0});return l.h.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_SUCCESS\",attachment:i.body.attachment}),i.body.attachment}catch(e){return l.h.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_FAIL\"}),new _.A(e)}}"},{"code":"async function eA(e,t){let n={};return null!=t&&(n.channel_id=t),(await s.Bo.post({url:$.Rsh.APPLICATION_PROXY_TICKET(e),body:n,rejectWithError:!0})).body.ticket}"},{"code":"async function ey(e){let t=$.Rsh.ACTIVITY_TEST_MODE(e);try{return await s.Bo.get({url:t,oldFormErrors:!0,rejectWithError:!0}),!0}catch(e){return!1}}"},{"code":"function eE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et.i.INDIRECT_ACTION;(0,A.$l)(o.M.ACTIVITIES_VOICE_LAUNCHER_BADGE,Math.floor(new Date().getTime()/1e3),{dismissAction:e})}"},{"code":"async function eh(e){var t,n,i,a;let{guildId:s,force:o=!1}=e,c=B.Ay.getShelfActivities(s),u=c.map(e=>y.A.getApplication(e.application_id)).filter(G.Vq);if(!o&&!B.Ay.shouldFetchShelf(s)){if(null==(t=B.Ay.getShelfFetchStatus(s))?void 0:t.isFetching){let e,t,n=new Promise(t=>{e=e_.bind(null,s,t),l.h.subscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",e)}),r=new Promise(e=>{t=e_.bind(null,s,e),l.h.subscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",t)});await Promise.race([n,r]),null!=e&&(l.h.unsubscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",e),e=null),null!=t&&(l.h.unsubscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",t),t=null)}return{activityConfigs:c,applications:u}}try{l.h.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF\",guildId:s});let e=void 0!==s&&\"\"!==s?{guild_id:s}:void 0,t=await V.A.get({url:$.Rsh.ACTIVITY_SHELF,query:e,trackedActionData:{event:r.NetworkActionNames.EMBEDDED_ACTIVITIES_FETCH_SHELF,properties:{guild_id:s}},retries:0,oldFormErrors:!0,rejectWithError:!0}),o=null!=(n=t.body.activities)?n:[],c=null!=(i=t.body.applications)?i:[],u=null!=(a=t.body.assets)?a:{};return l.h.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",guildId:s,activities:o,applications:c,assets:u}),c.length>0&&l.h.dispatch({type:\"APPLICATIONS_FETCH_SUCCESS\",applications:c}),{activityConfigs:o,applications:c.map(e=>P.Ay.createFromServer(e))}}catch(e){return l.h.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",guildId:s}),{activityConfigs:c,applications:u}}}"},{"code":"async function ef(){try{l.h.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_START\"});let e=await s.Bo.get({url:$.Rsh.APPLICATIONS_WITH_ASSETS,query:{with_team_applications:!0},oldFormErrors:!0,rejectWithError:!0}),t=e.body.applications,n=t.map(e=>P.Ay.createFromServer(e));l.h.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_SUCCESS\",applications:n,assets:e.body.assets}),l.h.dispatch({type:\"APPLICATIONS_FETCH_SUCCESS\",applications:t})}catch(e){l.h.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_FAIL\"})}}"},{"code":"async function eg(e){let{channelId:t,applicationId:n,userId:r,location:i,inviteAnalyticsMetadata:a,prefixedContent:s}=e,o=await f.Ay.createInvite(t,{target_type:en.yV.EMBEDDED_APPLICATION,target_application_id:n},i);await u.A.ensurePrivateChannel(r).then(e=>{let t,n=x.A.getChannel(e);if(null==n)throw Error(\"Private channel not found\");null!=s&&(t=C.Ay.parse(n,s).content),p.A.sendInvite(e,o.code,i,a,t)})}"},{"code":"function ed(e){let{location:t,applicationId:n,showFeedback:r=!0}=e,i=B.Ay.getSelfEmbeddedActivityForLocation(t);l.h.dispatch({type:\"EMBEDDED_ACTIVITY_CLOSE\",applicationId:n,location:t,instanceId:null==i?void 0:i.launchId,showFeedback:r});let a=(0,Y.H)(t);if(null!=a){var s;let e=v.A.getSelectedParticipantId(a),t=null==(s=M.default.getCurrentUser())?void 0:s.id,r=B.Ay.getEmbeddedActivitiesForChannel(a).find(e=>e.applicationId===n);if(null==r||null==t||\"\"===t)return;e===(0,O.Qt)({applicationId:n,instanceId:null==r?void 0:r.compositeInstanceId})&&d.A.selectParticipant(a,null)}}"},{"code":"function eb(e){l.h.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PANEL_MODE\",activityPanelMode:e})}"},{"code":"function eO(e){l.h.dispatch({type:\"EMBEDDED_ACTIVITY_SET_FOCUSED_LAYOUT\",focusedActivityLayout:e})}"},{"code":"function ev(){eb(J.Gd.ACTIVITY_POPOUT_WINDOW),l.h.dispatch({type:\"ACTIVITY_POPOUT_WINDOW_OPEN\"})}"},{"code":"async function eI(e,t){l.h.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PROXY_TICKET_REFRESHING\",applicationId:e,refreshing:!0});try{let n=await eA(e,null!=t?t:void 0);l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SET_PROXY_TICKET\",applicationId:e,channelId:t,proxyTicket:n}),l.h.dispatch({type:\"EMBEDDED_ACTIVITY_UPDATE_CONNECTED_PROXY_TICKET\",applicationId:e,proxyTicket:n})}catch(o){var n;let r=x.A.getChannel(t),a=null!=(n=null==r?void 0:r.guild_id)?n:null,s=null!=a?i.T.GUILD_CHANNEL:i.T.PRIVATE_CHANNEL;return l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_FAIL\",nonce:(0,N.m)(),applicationId:e,channelId:t,guildId:a,locationKind:s,error:o instanceof I.A||o instanceof _.A||o instanceof S.A?o:new _.A(o)}),!1}finally{l.h.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PROXY_TICKET_REFRESHING\",applicationId:e,refreshing:!1})}return!0}"},{"code":"function es(e){let t=B.Ay.getSelfEmbeddedActivityForLocation(e);null!=t&&ed({location:t.location,applicationId:t.applicationId,showFeedback:!1})}"},{"code":"async function eo(e){var t,r;let{channelId:a,applicationId:s,isStart:o,analyticsLocations:c,locationObject:u,embeddedActivitiesManager:d,componentId:f,commandOrigin:p,sectionName:h,source:m,onExecutedCallback:g,referrerId:E,customId:b,inviterUserId:O,onConfirmActivityLaunchChecksAlertOpen:v}=e,A=x.A.getChannel(a),C=null!=(t=null==A?void 0:A.getGuildId())?t:void 0;if(null==C&&!(null!=(r=null==A?void 0:A.isPrivate())&&r))return!1;let R=y.A.getApplication(s),P=null!=R&&(0,T.x)(R),D=(0,N.m)();try{if(w.A.getWindowOpen($.MLl.ACTIVITY_POPOUT)){let{close:e}=n(574172);e($.MLl.ACTIVITY_POPOUT)}if((0,X.y)({applicationId:s}))return!0;l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_START\",nonce:D,applicationId:s,channelId:null!=a?a:null,componentId:f,analyticsLocations:c,source:m,commandOrigin:p,inviterUserId:O,launchParams:{customId:b,referrerId:E}});let e=await eA(s,null!=a?a:void 0);l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SET_PROXY_TICKET\",applicationId:s,channelId:null!=a?a:null,proxyTicket:e});let t=M.default.getCurrentUser();if(null!=t&&(0,Z.A)({type:o?$.UqL.LAUNCH:$.UqL.JOIN,userId:null==t?void 0:t.id,guildId:C,channelId:a,channelType:null==A?void 0:A.type,applicationId:s,locationObject:u,analyticsLocations:null!=c?c:[],source:m,referrerId:E,inviterUserId:O}),o){if(null==a||!el(s,A))throw new I.A(I.A.Reasons.INVALID_CHANNEL);let e=await ec({applicationId:s,nonce:D,channelId:a,guildId:C,commandOrigin:p,sectionName:h,source:m,onExecutedCallback:g,onConfirmActivityLaunchChecksAlertOpen:v,embeddedActivitiesManager:d});if(\"failure\"===e.result)if(4===e.reason)return l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_CANCEL\",nonce:D,applicationId:s,channelId:null!=a?a:null}),!1;else throw new I.A(I.A.Reasons.PRIMARY_APP_COMMAND_NOT_FOUND)}else{let e=await eu({applicationId:s,channelId:a,embeddedActivitiesManager:d,isStart:o,guildId:C});if(null==g||g(),\"failure\"===e.result)throw new I.A(I.A.Reasons.LEGACY_LAUNCH_CLIENT_VALIDATION_FAILED,e.reason)}l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SUCCESS\",nonce:D,applicationId:s,channelId:null!=a?a:null})}catch(t){if(P)return!1;let e=null!=C?i.T.GUILD_CHANNEL:i.T.PRIVATE_CHANNEL;return l.h.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_FAIL\",nonce:D,applicationId:s,channelId:null!=a?a:null,guildId:null!=C?C:null,isStart:o,error:t instanceof I.A||t instanceof _.A||t instanceof S.A?t:new _.A(t),locationKind:e}),!1}return!0}"},{"code":"async function em(e){let{activityChannelId:t,invitedChannelId:n,applicationId:r,location:i,inviteAnalyticsMetadata:a}=e,s=await f.Ay.createInvite(t,{target_type:en.yV.EMBEDDED_APPLICATION,target_application_id:r},i);null!=x.A.getChannel(n)&&p.A.sendInvite(n,s.code,i,a)}"}]