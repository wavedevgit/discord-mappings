[{"code":"class et extends(i=o.PureComponent){static getDerivedStateFromProps(e,t){return!e.playable&&t.playing?{playing:!1,hideControls:!1}:null}componentDidMount(){let{playing:e,muted:t,volume:n}=this.state,{type:r,src:i}=this.props;if(r===Y.VIDEO&&(T.ZP.addChangeListener(this.handleStatsStoreChange),this._hasStatsListener=!0,T.ZP.isVideoStatsEnabled(i)&&!this.state.showStats))try{this.toggleStats()}catch(e){T.ZP.setVideoStats(i,!1)}let{current:a}=this.mediaRef;null!=a&&(t&&(a.muted=t),e&&(this.play(!0),this.handleUIUpdate()),a.volume=n)}componentDidUpdate(e,t){let{props:{onPause:n,onVolumeChange:r,onMute:i,src:a,type:o},state:{playing:s,fullscreen:l,muted:c,dragging:u,volume:d,showStats:f}}=this;if(a!==e.src&&o===Y.VIDEO){null!=this._statsCollector&&this._statsCollector.resetCodecInfo(this.props.fileSizeBytes),T.ZP.clearVideoStats(e.src);let t=T.ZP.isVideoStatsEnabled(a);f!==t&&(t?this.toggleStats():f&&this.toggleStats())}let{current:p}=this.mediaRef,{current:_}=this.playPausePopRef;if(null==p)return;s&&!t.playing?(this.play(),this.handleMouseMove(),this.handleUIUpdate(),t.hasClickedPlay&&(null==_||_.pop(s))):!s&&t.playing&&(p.pause(),null==_||_.pop(s),null==n||n()),s&&null==this._analytics.metadata.hasValidFrame&&this.checkVideoDecodability();let h=(0,I.fn)(p.parentNode,p);l&&!t.fullscreen&&null!=h?((0,I.Dj)(h),h.addEventListener(I.NO,this.handleFullScreenExit)):!l&&t.fullscreen&&null!=h&&(h.removeEventListener(I.NO,this.handleFullScreenExit),(0,I.Pr)(h,h.ownerDocument)),u===C.Z.Types.DURATION&&t.dragging!==C.Z.Types.DURATION&&s?p.pause():u!==C.Z.Types.DURATION&&t.dragging===C.Z.Types.DURATION&&s&&p.play(),c!==t.muted&&(p.muted=c,null==i||i(c)),d!==t.volume&&(p.volume=d,null==r||r(d))}componentWillUnmount(){this._unmounted=!0,null!=this._statsCollector&&(this._statsCollector.destroy(),this._statsCollector=null),this._hasStatsListener&&(T.ZP.removeChangeListener(this.handleStatsStoreChange),this._hasStatsListener=!1,this.props.type===Y.VIDEO&&T.ZP.clearVideoStats(this.props.src));let{current:e}=this.mediaRef;if(null==e)return;let t=(0,I.fn)(e.parentNode,e);null!=t&&(t.removeEventListener(I.NO,this.handleFullScreenExit),(0,I.Pr)(t))}play(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{onPlay:t,volume:n,autoMute:r}=this.props,{current:i}=this.mediaRef;if(null!=i){let a={};if(\"function\"==typeof n){let e=n();e!==this.state.volume&&(i.volume=e,a.volume=e)}if(\"function\"==typeof r){let e=r();e!==this.state.muted&&(i.muted=e,a.muted=e)}this.setState(a),i.play(),null==t||t(e,i.currentTime*v.Z.Millis.SECOND,i.duration*v.Z.Millis.SECOND)}}getWidth(){let{width:e}=this.props;return\"100%\"===e?e:Math.max(e,et.minWidth)}getHeight(){let{height:e}=this.props;return\"100%\"===e?e:Math.max(e,et.minHeight)}updateValue(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{current:n}=this.controlsRef;null!=n&&n.updateProgress(e,t)}updateTime(e,t){let n=0|e,r=0|t;(this.state.currentTime!==n||this.state.duration!==r)&&this.setState({currentTime:n,duration:r})}updateControlsVisibility(){let{dragging:e,fullscreen:t}=this.state,n=t?B:F,r=Math.max(0,Date.now()-this._lastMove)>n;r!==this.state.hideControls&&null==e&&this.setState({hideControls:r})}renderVideo(){let{alt:e,src:t,poster:n,forceExternal:r,responsive:i,mediaLayoutType:o}=this.props,{playing:s,fullscreen:l}=this.state,c=this.getWidth(),u=this.getHeight();return r?(0,a.jsx)(h.Z,{alt:e,className:j.video,controls:!1,height:u,poster:n,width:c,responsive:i&&!l,mediaLayoutType:o,playsInline:!0,autoPlay:s}):(0,a.jsx)(h.Z,{alt:e,className:j.video,controls:!1,playsInline:!0,autoPlay:s,height:u,responsive:i&&!l,mediaLayoutType:l?x.hV.STATIC:o,onClick:this.handleVideoClick,onEnded:this.handleEnded,onError:this.handleError,onWaiting:this._analytics.onWaiting,onSeeking:this._analytics.onSeeking,onSeeked:this._analytics.onSeeked,onPause:this._analytics.onPause,onPlaying:this._analytics.onPlaying,onTimeUpdate:this._analytics.onTimeUpdate,onLoadedMetadata:this.handleLoaded,onProgress:this.handleBuffer,poster:n,preload:this.state.preload,ref:this.mediaRef,width:c,src:t})}renderAudio(){return(0,a.jsx)(\"audio\",{className:j.audio,controls:!1,onClick:this.handleVideoClick,onEnded:this.handleEnded,onLoadedMetadata:this.handleLoaded,onProgress:this.handleBuffer,preload:this.state.preload,ref:this.mediaRef,children:(0,a.jsx)(\"source\",{src:this.props.src})})}renderControls(){let{current:e}=this.mediaRef,{props:{type:t,autoPlay:n,playable:r=!0,onVolumeShow:i,onVolumeHide:o,onControlsHide:s,onControlsShow:l},state:{buffers:c,currentTime:u,duration:d,hasClickedPlay:f,hideControls:p,muted:_,playing:h,fullscreen:m,volume:g,dragging:b}}=this,y=this.getWidth();return f||n||t===Y.AUDIO?(0,a.jsx)(Q,{buffers:c,currentTime:u,duration:d,volume:(0,S.P)(g,1),hide:t===Y.VIDEO&&p,muted:_,autoPlay:n,onDrag:this.handleDrag,onDragEnd:this.handleDragEnd,onDragStart:this.handleDragStart,onPause:()=>this.setPlay(!1),onPlay:()=>this.setPlay(!0),onToggleMuted:this.toggleMuted,onVolumeShow:i,onVolumeHide:o,onControlsShow:l,onControlsHide:s,playing:h,dragging:b,type:t,ref:this.controlsRef,width:m?window.screen.width:y,disabled:!r,children:t===Y.VIDEO?(0,a.jsx)(E.Z,{\"aria-label\":L.intl.string(L.t[\"2nM3Pk\"]),className:j.videoButton,iconClassName:j.controlIcon,guestWindow:window,onClick:this.toggleFullscreen,node:(0,I.fn)(null==e?void 0:e.parentNode,e)}):null}):(0,a.jsx)(A.Z,{onPlay:this.handleVideoClick,inactive:!r})}renderMetadata(){let{fileName:e,fileSize:t,src:n,type:r,playable:i,mimeType:o}=this.props;return null==e||null==t?null:r===Y.AUDIO?(0,a.jsx)(X,{fileName:e,fileSize:t,src:n,disabled:!i,mimeType:o,hideDownloadButton:!0}):null}renderPlayPausePop(){return(0,a.jsx)(J,{ref:this.playPausePopRef})}getMediaStyle(){let{responsive:e,type:t,height:n}=this.props,{fullscreen:r}=this.state,i=this.getWidth();return r?W:t===Y.AUDIO?{width:void 0,height:\"auto\"}:e?void 0:{width:i,height:n}}render(){let{height:e,type:t,src:n,forceExternal:r,className:i,renderLinkComponent:o,responsive:s,mediaLayoutType:c,renderOverlayContent:u}=this.props,{fullscreen:d,hideControls:f,playing:p}=this.state,h=j.wrapperPaused;if(t===Y.AUDIO?h=j.wrapperAudio:f?h=j.wrapperControlsHidden:p&&(h=j.wrapperPlaying),r&&t===Y.VIDEO){let t=this.getWidth();return(0,a.jsxs)(\"div\",{className:l()(h,{[j.wrapperMediaMosaic]:c===x.hV.MOSAIC}),style:s?void 0:{width:t,height:e},onKeyDown:this.handleKeyDown,tabIndex:0,children:[this.renderMetadata(),this.renderVideo(),(0,a.jsx)(\"div\",{className:j.playCenter,children:(0,a.jsx)(N.Z,{className:j.__invalid_playButton,externalURL:n,renderLinkComponent:o})})]})}return(0,a.jsxs)(\"div\",{className:l()(h,j.newMosaicStyle,i,{[j.wrapperMediaMosaic]:c===x.hV.MOSAIC}),\"data-fullscreen\":d,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseMove:p?this.handleMouseMove:void 0,onKeyDown:this.handleKeyDown,tabIndex:0,style:this.getMediaStyle(),children:[this.renderMetadata(),t===Y.AUDIO?this.renderAudio():this.renderVideo(),(0,a.jsx)(_.f6W,{theme:D.BRd.MIDNIGHT,children:e=>(0,a.jsx)(\"div\",{className:e,children:this.renderControls()})}),t===Y.VIDEO?this.renderPlayPausePop():null,null!=u?(0,a.jsx)(\"div\",{className:l()({[j.overlayContentHidden]:p||d}),children:u()}):null,t===Y.VIDEO&&this.state.showStats&&null!=this.state.videoStats?(0,a.jsx)(w._,{stats:this.state.videoStats,onClose:this.toggleStats}):null]})}checkVideoDecodability(){let{current:e}=this.mediaRef;if(null==e||!(0,f.kK)(e,HTMLVideoElement))return;if(this.props.type!==Y.VIDEO){this._analytics.metadata.hasValidFrame=!0;return}if(null!=this._analytics.metadata.hasValidFrame)return;let t=e.videoHeight,n=e.currentTime,r=e.readyState;if(0===t&&r>=2)return void setTimeout(()=>{if(null==e)return;let t=e.videoHeight,r=e.currentTime;if(0===t&&r>n+.5){this._analytics.metadata.hasValidFrame=!1;return}if(t>0){this._analytics.metadata.hasValidFrame=!0;return}},1500);if(t>0){this._analytics.metadata.hasValidFrame=!0;return}}constructor(e){var t,n;super(e),t=this,k(this,\"_unmounted\",!1),k(this,\"_lastMove\",0),k(this,\"_analytics\",void 0),k(this,\"_statsCollector\",null),k(this,\"_hasStatsListener\",!1),k(this,\"mediaRef\",o.createRef()),k(this,\"controlsRef\",o.createRef()),k(this,\"playPausePopRef\",o.createRef()),k(this,\"handleFullScreenExit\",()=>{let{current:e}=this.mediaRef;if(null==e)return;let t=(0,I.fn)(e.parentNode,e);null!=t&&(0,I.rB)(t,null==t?void 0:t.ownerDocument)||this.setState({fullscreen:!1})}),k(this,\"toggleFullscreen\",()=>{let e=!this.state.fullscreen;this.setState({fullscreen:e})}),k(this,\"setMuted\",e=>{this.setState({muted:e})}),k(this,\"toggleMuted\",()=>{this.setMuted(!this.state.muted)}),k(this,\"setTime\",function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],{current:r}=t.mediaRef;null!=r&&isFinite(r.duration)&&isFinite(r.currentTime)&&(r.currentTime=e,t.updateValue(e/r.duration,n),t.updateTime(e,r.duration))}),k(this,\"handleUIUpdate\",()=>{if(!this.state.playing||this._unmounted)return;let{current:e}=this.mediaRef;null!=e&&(e.duration>0&&this.updateValue(e.currentTime/e.duration),this.updateTime(e.currentTime,e.duration),this.updateControlsVisibility(),requestAnimationFrame(this.handleUIUpdate))}),k(this,\"handleDrag\",(e,t)=>{let{current:n}=this.mediaRef;if(t===C.Z.Types.DURATION)null!=n&&isFinite(n.duration)&&this.setTime(n.duration*e,!1);else if(t===C.Z.Types.VOLUME){let t=(0,S.A)(e,1);0===t?this.setState({muted:!0,volume:t}):this.state.muted&&t>0?this.setState({muted:!1,volume:t}):this.setState({volume:t})}}),k(this,\"handleLoaded\",e=>{this._analytics.onLoadedMetadata(e);let{current:t}=this.mediaRef;null!=t&&(this.updateTime(t.currentTime,t.duration),this.setState({hasLoadedMetadata:!0,currentTime:t.currentTime,duration:t.duration}))}),k(this,\"handleDurationChange\",()=>{let{current:e}=this.mediaRef;null!=e&&(this.updateTime(e.currentTime,e.duration),this.setState({duration:e.duration}))}),k(this,\"handleBuffer\",u().debounce(()=>{let{current:e}=this.mediaRef;if(null==e)return void this.setState({buffers:[]});this.setState({buffers:z(e)})},400)),k(this,\"handleEnded\",e=>{let{onEnded:t}=this.props;null!=t&&t(e),this.setState({playing:!1,hideControls:!1})}),k(this,\"handleMouseMove\",()=>{this._lastMove=Date.now()}),k(this,\"handleMouseLeave\",()=>{this.state.playing&&(this._lastMove=0),this.setState({hovering:!1})}),k(this,\"handleMouseEnter\",()=>{\"none\"===this.state.preload&&this.setState({preload:\"metadata\"}),this.setState({hovering:!0})}),k(this,\"handleVideoClick\",e=>{let{state:{hasClickedPlay:t,playing:n},props:{onClick:r,autoPlay:i,autoMute:a}}=this;if(null!=r)return void r(e);e.stopPropagation(),i&&!t&&n&&a?this.setState({muted:!1,hasClickedPlay:!0}):this.setPlay(!this.state.playing)}),k(this,\"setPlay\",e=>{let{props:{autoMute:t},state:{hasClickedPlay:n,muted:r}}=this;e!==this.state.playing&&(e?this.setState({playing:e,hasClickedPlay:!0,muted:(!!n||!t)&&r}):this.setState({playing:!1,hideControls:!1}))}),k(this,\"handleDragStart\",e=>{var t,n;this.setState({dragging:e}),this._analytics.onDragStart(null!=(n=null==(t=this.mediaRef.current)?void 0:t.currentTime)?n:null)}),k(this,\"handleDragEnd\",()=>{this.setState({dragging:null}),this._lastMove=Date.now()}),k(this,\"handleKeyDown\",e=>{let{current:t}=this.mediaRef,{disableArrowKeySeek:n}=this.props;if(e.which===D.yXg.SPACE)e.preventDefault(),this.setPlay(!this.state.playing);else if(e.which!==D.yXg.ARROW_LEFT||null==t||n)if(e.which!==D.yXg.ARROW_RIGHT||null==t||n){if(e.which>=D.yXg.DIGIT_0&&e.which<=D.yXg.DIGIT_9&&null!=t){e.preventDefault(),e.stopPropagation();let n=(e.which-D.yXg.DIGIT_0)/10;t.currentTime=t.duration*n,this.setPlay(!0)}}else{e.preventDefault(),e.stopPropagation();let n=Math.min(isFinite(t.duration)?t.duration:0,t.currentTime+5);this.setTime(n)}else{e.preventDefault(),e.stopPropagation();let n=Math.max(0,t.currentTime-5);this.setTime(n)}}),k(this,\"handleError\",e=>{var t,n,r,i;let a=e.currentTarget;this._analytics.errorCode=null!=(r=null==(t=a.error)?void 0:t.code)?r:null,this._analytics.errorMessage=null!=(i=null==(n=a.error)?void 0:n.message)?i:null,this._analytics.onError(e)}),k(this,\"_isUpdatingStats\",!1),k(this,\"toggleStats\",()=>{let{showStats:e}=this.state,{current:t}=this.mediaRef,{src:n}=this.props;if(e)null!=this._statsCollector&&this._statsCollector.stopTracking(),this._isUpdatingStats=!0,this.setState({showStats:!1},()=>{this._isUpdatingStats=!1,this._unmounted||T.ZP.setVideoStats(this.props.src,!1)});else if(null!=t&&(0,f.kK)(t,HTMLVideoElement))try{null==this._statsCollector&&(this._statsCollector=new P.Z(t,this.props.fileSizeBytes)),this._statsCollector.startTracking(this.handleStatsUpdate),this._isUpdatingStats=!0,this.setState({showStats:!0,videoStats:this._statsCollector.getStats()},()=>{this._isUpdatingStats=!1,this._unmounted||T.ZP.setVideoStats(this.props.src,!0)})}catch(e){null!=this._statsCollector&&(this._statsCollector.destroy(),this._statsCollector=null),this._isUpdatingStats=!1,this._unmounted||T.ZP.setVideoStats(this.props.src,!1)}else T.ZP.setVideoStats(n,!1)}),k(this,\"handleStatsUpdate\",e=>{this.setState({videoStats:e})}),k(this,\"handleStatsStoreChange\",()=>{let{src:e,type:t}=this.props;t!==Y.VIDEO||this._isUpdatingStats||T.ZP.isVideoStatsEnabled(e)!==this.state.showStats&&this.toggleStats()}),this._analytics=new ee({src:e.src,mimeType:null==(n=e.mimeType)?void 0:n.join(\"/\"),fileSize:e.fileSizeBytes});let{autoPlay:r,autoMute:i,volume:a,playable:s}=this.props,l=\"function\"==typeof a?a():a,c=\"function\"==typeof i?i():i;this.state={buffers:[],currentTime:null,dragging:null,duration:null,fullscreen:!1,hasClickedPlay:!1,hasLoadedMetadata:!1,hideControls:!s,muted:c,volume:l,playing:r,preload:\"none\",width:et.minWidth,height:et.minHeight,hovering:!1,showStats:!1,videoStats:null}}}"},{"code":"function K(e){let t=0|e,n=t%60;return\"\".concat((t-n)/60,\":\").concat(String(n).padStart(2,\"0\"))}"}]