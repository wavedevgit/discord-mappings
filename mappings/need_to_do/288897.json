[{"code":"class N extends i.PureComponent{componentDidMount(){this.props.editor.events.addListener(\"onChange\",this.handleOnChange)}componentDidUpdate(e,t,n){e.editor!==this.props.editor&&(e.editor.events.removeListener(\"onChange\",this.handleOnChange),this.props.editor.events.addListener(\"onChange\",this.handleOnChange))}componentWillUnmount(){this.props.editor.events.removeListener(\"onChange\",this.handleOnChange)}componentDidCatch(e,t){d.Z.captureException(e,{extra:t}),this.setState({initialValue:[...this.props.editor.children]})}renderElement(e){var t;let{guildId:n,channelId:i,renderExtraElement:a}=this.props,{attributes:o,children:s}=e;\"rtl\"===o.dir&&(o.style=T(S({},o.style),{textAlign:\"right\"}));let l=null!=(t=null==a?void 0:a(e))?t:(0,g.Z)(e,n,i);return null!=l?l:(0,r.jsx)(\"div\",T(S({},o),{children:s}))}renderLeaf(e){var t;let{editor:n,renderExtraLeaf:i}=this.props,{attributes:a,children:o}=e,s=null!=(t=null==i?void 0:i(e))?t:(0,E.Z)(n,e);return null!=s?s:(0,r.jsx)(\"span\",T(S({},a),{children:o}))}handleOnChange(){var e,t;let{editor:n}=this.props,r=m.bN.isEditorEmpty(n)&&null==n.composition;if(r!==this.state.showPlaceholder&&this.setState({showPlaceholder:r}),null==(e=(t=this.props).onChange)||e.call(t,m.bN.richValue(n)),!1===this.props.canFocus){let e=s.F3.findDocumentOrShadowRoot(n).getSelection();null!=e&&this.isSelectionPartiallyInside(e)&&(null==e||e.removeAllRanges())}}handleKeyDown(e){var t,n;if(null!=this.props.editor.composition){e.preventDefault(),e.stopPropagation();return}null==(t=(n=this.props).onKeyDown)||t.call(n,e)}handleKeyUp(e){var t,n;if(null!=this.props.editor.composition){e.preventDefault(),e.stopPropagation();return}null==(t=(n=this.props).onKeyUp)||t.call(n,e)}handleBeforeInput(e){var t;let{editor:n}=this.props,r=s.F3.findDocumentOrShadowRoot(n).getSelection(),i=null!=r&&r.rangeCount>0?r.getRangeAt(0):null,a=null!=(t=e.getTargetRanges()[0])?t:null;if(null==n.composition){if((\"insertText\"===e.inputType||\"insertReplacementText\"===e.inputType)&&(null==a&&(a=i),null!=a)){let t=m.bN.toSlateRange(n,a,{exactMatch:!1,suppressThrow:!0});null!=t&&null!=e.data&&(m.M8.isExpanded(t)?p.T.withSingleEntry(n,()=>{n.selection=t,n.deleteFragment(),n.insertText(e.data),e.preventDefault()}):(n.insertText(e.data),e.preventDefault()))}if(e.inputType.startsWith(\"deleteContent\")&&null!=i&&!i.collapsed){let t=m.bN.toSlateRange(n,i,{exactMatch:!0,suppressThrow:!0});null!=t&&m.M8.isExpanded(t)&&(n.selection=t,n.deleteFragment(e.inputType.endsWith(\"Backward\")?\"backward\":\"forward\"),e.preventDefault())}}}handleCompositionStart(){var e,t;let{editor:n}=this.props,r={insertedPrefix:!1,startedInsideInline:!1};this.state.showPlaceholder&&this.setState({showPlaceholder:!1});let i=null!=n.selection&&m.M8.isCollapsed(n.selection)?m.bN.leaf(n,n.selection.anchor.path):null;if(null==i){n.composition=r;return}if(null!=(null!=n.selection&&m.M8.isCollapsed(n.selection)?m.bN.above(n,{at:i[1],match:e=>m.bN.isInline(n,e),mode:\"lowest\"}):null)&&(r.startedInsideInline=!0),m.bN.isEditorEmpty(n)){h.Q.insertNodes(n,{text:\"\\uFEFF\"},{select:!0}),r.insertedPrefix=!0,n.composition=r;return}let a=s.F3.findDocumentOrShadowRoot(this.props.editor).getSelection(),o=(null!=(e=null==a?void 0:a.rangeCount)?e:0)>0?null==a?void 0:a.getRangeAt(0):null;if(null==(null!=o?m.bN.toSlateRange(n,o,{exactMatch:!0,suppressThrow:!0}):null)&&null!=o){let e=m.bN.toSlateRange(n,o,{exactMatch:!1,suppressThrow:!0});n.selection=null,null!=e?h.Q.select(n,e):h.Q.select(n,null!=(t=n.selection)?t:m.bN.end(n,[]))}n.composition=r}handleCompositionEnd(e){let{editor:t}=this.props;if(null==t.composition)return;let{insertedPrefix:n}=t.composition;if(n&&null!=t.selection&&m.M8.isCollapsed(t.selection)){let e=t.selection.anchor.path,n=m.aj.leaf(t,e);m.bN.withoutNormalizing(t,()=>{let e=n.text.replace(/^\\uFEFF/,\"\");h.Q.delete(t,{unit:\"offset\",distance:n.text.length,reverse:!0}),m.bN.insertText(t,e)})}t.composition=null}handleFocusCapture(e){let{onFocus:t}=this.props;null==t||t(e)}handleBlurCapture(e){let{editor:t,onBlur:n}=this.props,r=e.relatedTarget,i=s.F3.findDocumentOrShadowRoot(this.props.editor),a=i.getElementById(\"textarea-context\"),o=i.getElementById(\"slate-toolbar\");if(null!=r&&!(0,_.hasDomParent)(r,a)&&!(0,_.hasDomParent)(r,o)){let e=s.F3.findDocumentOrShadowRoot(t).getSelection();null!=e&&this.isSelectionEscaping(e)&&e.removeAllRanges()}null==n||n(e)}isSelectionPartiallyInside(e){let t=this.containerRef.current;if(null!=e&&null!=t)for(let n=e.rangeCount-1;n>=0;n--){let r=e.getRangeAt(n),i=r.startContainer,a=r.endContainer,o=r.startOffset,s=r.endOffset;if((0,_.hasDomParent)(i,t)||!(0,_.isDOMRangeCollapsed)(i,o,a,s)&&(0,_.hasDomParent)(a,t))return!0}return!1}isSelectionEscaping(e){let t=this.containerRef.current,n=!1,r=!1;if(null!=e&&null!=t)for(let i=e.rangeCount-1;i>=0;i--){let a=e.getRangeAt(i),o=a.startContainer,s=a.endContainer,l=a.startOffset,c=a.endOffset;if((0,_.hasDomParent)(o,t)){if(r)return!0;n=!0}else{if(n)return!0;r=!0}if(!(0,_.isDOMRangeCollapsed)(o,l,s,c))if((0,_.hasDomParent)(o,t)){if(r)return!0;n=!0}else{if(n)return!0;r=!0}}return!1}handleContextMenu(e){let{editor:t}=this.props,i=e.pageY,a=window.innerHeight,o=null!=i&&null!=a&&i<a/2?\"top\":\"bottom\";if(u.isPlatformEmbedded){let i=(0,c.GB)();(0,l.jW)(e,async()=>{let{default:e}=await n.e(\"41984\").then(n.bind(n,343602));return n=>(0,r.jsx)(e,T(S({},n),{editor:t,text:m.bN.getSelectedText(t,!0)}))},{align:o,enableSpellCheck:i===b.IlC.APP})}else blur()}handlePasteCapture(e){let{editor:t,onPaste:n,readOnly:r}=this.props;null==n||n(e),e.isDefaultPrevented()||e.isPropagationStopped()||r||(t.insertData(e.clipboardData),e.preventDefault(),e.stopPropagation())}render(){let e=this.props,{editor:t,className:n,containerClassName:i,canFocus:a,autoFocus:l,placeholder:c,decorate:u,channelId:d,guildId:f,onChange:p,onFocus:_,onBlur:h,onKeyDown:m,onKeyUp:g,renderExtraElement:E,renderExtraLeaf:b}=e,v=C(e,[\"editor\",\"className\",\"containerClassName\",\"canFocus\",\"autoFocus\",\"placeholder\",\"decorate\",\"channelId\",\"guildId\",\"onChange\",\"onFocus\",\"onBlur\",\"onKeyDown\",\"onKeyUp\",\"renderExtraElement\",\"renderExtraLeaf\"]);return(0,r.jsxs)(\"div\",{ref:this.containerRef,className:i,children:[this.state.showPlaceholder?(0,r.jsx)(\"div\",{className:o()(y.placeholder,n),\"aria-hidden\":!0,children:c}):null,(0,r.jsx)(s.mH,{editor:t,value:[...this.state.initialValue],children:(0,r.jsx)(s.CX,T(S({},v),{className:o()(O.markup,y.editor,n),decorate:u,renderElement:this.renderElement,renderLeaf:this.renderLeaf,onFocusCapture:this.handleFocusCapture,onBlurCapture:this.handleBlurCapture,onContextMenu:this.handleContextMenu,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onDOMBeforeInput:this.handleBeforeInput,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onPasteCapture:this.handlePasteCapture,autoFocus:l&&!1!==a,autoCorrect:\"off\",\"data-can-focus\":!1!==a,\"aria-label\":c,\"aria-multiline\":!0}))})]})}constructor(e){super(e),v(this,\"containerRef\",i.createRef()),v(this,\"state\",void 0),this.renderElement=this.renderElement.bind(this),this.renderLeaf=this.renderLeaf.bind(this),this.handleOnChange=this.handleOnChange.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleKeyUp=this.handleKeyUp.bind(this),this.handleBeforeInput=this.handleBeforeInput.bind(this),this.handleCompositionStart=this.handleCompositionStart.bind(this),this.handleCompositionEnd=this.handleCompositionEnd.bind(this),this.handleFocusCapture=this.handleFocusCapture.bind(this),this.handleBlurCapture=this.handleBlurCapture.bind(this),this.handleContextMenu=this.handleContextMenu.bind(this),this.handlePasteCapture=this.handlePasteCapture.bind(this),m.bN.isEditorEmpty(e.editor)?this.state={initialValue:(0,f.H2)().richValue,showPlaceholder:!0}:this.state={initialValue:m.bN.richValue(e.editor),showPlaceholder:!1}}}"}]