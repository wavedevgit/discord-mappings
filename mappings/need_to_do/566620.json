[{"code":"async function e_(){try{l.Z.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_START\"});let e=await o.tn.get({url:et.ANM.APPLICATIONS_WITH_ASSETS,query:{with_team_applications:!0},oldFormErrors:!0,rejectWithError:!0}),t=e.body.applications,n=t.map(e=>L.ZP.createFromServer(e));l.Z.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_SUCCESS\",applications:n,assets:e.body.assets}),l.Z.dispatch({type:\"APPLICATIONS_FETCH_SUCCESS\",applications:t})}catch(e){l.Z.dispatch({type:\"DEVELOPER_ACTIVITY_SHELF_FETCH_FAIL\"})}}"},{"code":"async function ec(e){var t,r;let{channelId:a,applicationId:o,isStart:s,analyticsLocations:c,locationObject:u,embeddedActivitiesManager:d,componentId:f,commandOrigin:p,sectionName:h,source:m,onExecutedCallback:g,referrerId:E,customId:y,inviterUserId:O,onConfirmActivityLaunchChecksAlertOpen:v}=e,S=M.Z.getChannel(a),w=null!=(t=null==S?void 0:S.getGuildId())?t:void 0;if(null==w&&!(null!=(r=null==S?void 0:S.isPrivate())&&r))return!1;let x=b.Z.getApplication(o),L=null!=x&&(0,N.g)(x),j=(0,R.r)();try{if(D.Z.getWindowOpen(et.KJ3.ACTIVITY_POPOUT)){let{close:e}=n(788983);e(et.KJ3.ACTIVITY_POPOUT)}let e=A.Z.getConnectedFrame();if(null!=e&&(0,P.Z)().leaveFrame({applicationId:e.applicationId}),L)return await C.Z.launchFrame({applicationId:o}),!0;l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_START\",nonce:j,applicationId:o,channelId:null!=a?a:null,componentId:f,analyticsLocations:c,source:m,commandOrigin:p,inviterUserId:O,launchParams:{customId:y,referrerId:E}});let t=await eT(o,null!=a?a:void 0);l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SET_PROXY_TICKET\",applicationId:o,channelId:null!=a?a:null,proxyTicket:t});let r=G.default.getCurrentUser();if(null!=r&&(0,J.Z)({type:s?et.q5t.LAUNCH:et.q5t.JOIN,userId:null==r?void 0:r.id,guildId:w,channelId:a,channelType:null==S?void 0:S.type,applicationId:o,locationObject:u,analyticsLocations:null!=c?c:[],source:m,referrerId:E,inviterUserId:O}),s){if(null==a||!eu(o,S))throw new I.Z(I.Z.Reasons.INVALID_CHANNEL);let e=await ed({applicationId:o,nonce:j,channelId:a,guildId:w,commandOrigin:p,sectionName:h,source:m,onExecutedCallback:g,onConfirmActivityLaunchChecksAlertOpen:v,embeddedActivitiesManager:d});if(\"failure\"===e.result)if(4===e.reason)return l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_CANCEL\",nonce:j,applicationId:o,channelId:null!=a?a:null}),!1;else throw new I.Z(I.Z.Reasons.PRIMARY_APP_COMMAND_NOT_FOUND)}else{let e=await ef({applicationId:o,channelId:a,embeddedActivitiesManager:d,isStart:s,guildId:w});if(null==g||g(),\"failure\"===e.result)throw new I.Z(I.Z.Reasons.LEGACY_LAUNCH_CLIENT_VALIDATION_FAILED,e.reason)}l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SUCCESS\",nonce:j,applicationId:o,channelId:null!=a?a:null})}catch(t){if(L)return!1;let e=null!=w?i.E.GUILD_CHANNEL:i.E.PRIVATE_CHANNEL;return l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_FAIL\",nonce:j,applicationId:o,channelId:null!=a?a:null,guildId:null!=w?w:null,isStart:s,error:t instanceof I.Z||t instanceof _.Z||t instanceof T.Z?t:new _.Z(t),locationKind:e}),!1}return!0}"},{"code":"function eI(){ev(ee.Ez.ACTIVITY_POPOUT_WINDOW),l.Z.dispatch({type:\"ACTIVITY_POPOUT_WINDOW_OPEN\"})}"},{"code":"async function eO(e){let t=et.ANM.ACTIVITY_TEST_MODE(e);try{return await o.tn.get({url:t,oldFormErrors:!0,rejectWithError:!0}),!0}catch(e){return!1}}"},{"code":"async function eT(e,t){let n={};return null!=t&&(n.channel_id=t),(await o.tn.post({url:et.ANM.APPLICATION_PROXY_TICKET(e),body:n,rejectWithError:!0})).body.ticket}"},{"code":"function el(e){let t=Y.ZP.getSelfEmbeddedActivityForLocation(e);null!=t&&ep({location:t.location,applicationId:t.applicationId,showFeedback:!1})}"},{"code":"function eS(e){l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_SET_FOCUSED_LAYOUT\",focusedActivityLayout:e})}"},{"code":"async function eh(e,t,n){try{l.Z.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_START\"});let r=null!=t?{channel_id:t}:void 0,i=await o.tn.post({url:et.ANM.APPLICATION_UPLOAD_ATTACHMENT(e),query:r,attachments:[{name:\"file\",file:n}],rejectWithError:!0});return l.Z.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_SUCCESS\",attachment:i.body.attachment}),i.body.attachment}catch(e){return l.Z.dispatch({type:\"UPLOAD_ACTIVITY_IMAGE_ATTACHMENT_FAIL\"}),new _.Z(e)}}"},{"code":"function ep(e){let{location:t,applicationId:n,showFeedback:r=!0}=e,i=Y.ZP.getSelfEmbeddedActivityForLocation(t);l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_CLOSE\",applicationId:n,location:t,instanceId:null==i?void 0:i.launchId,showFeedback:r});let a=(0,K.p)(t);if(null!=a){var o;let e=v.Z.getSelectedParticipantId(a),t=null==(o=G.default.getCurrentUser())?void 0:o.id,r=Y.ZP.getEmbeddedActivitiesForChannel(a).find(e=>e.applicationId===n);if(null==r||null==t||\"\"===t)return;e===(0,O.gN)({applicationId:n,instanceId:null==r?void 0:r.compositeInstanceId})&&d.Z.selectParticipant(a,null)}}"},{"code":"async function eC(e,t){l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PROXY_TICKET_REFRESHING\",applicationId:e,refreshing:!0});try{let n=await eT(e,null!=t?t:void 0);l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_SET_PROXY_TICKET\",applicationId:e,channelId:t,proxyTicket:n}),l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_UPDATE_CONNECTED_PROXY_TICKET\",applicationId:e,proxyTicket:n})}catch(s){var n;let r=M.Z.getChannel(t),a=null!=(n=null==r?void 0:r.guild_id)?n:null,o=null!=a?i.E.GUILD_CHANNEL:i.E.PRIVATE_CHANNEL;return l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_LAUNCH_FAIL\",nonce:(0,R.r)(),applicationId:e,channelId:t,guildId:a,locationKind:o,error:s instanceof I.Z||s instanceof _.Z||s instanceof T.Z?s:new _.Z(s)}),!1}finally{l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PROXY_TICKET_REFRESHING\",applicationId:e,refreshing:!1})}return!0}"},{"code":"async function eb(e){let{channelId:t,applicationId:n,userId:r,location:i,inviteAnalyticsMetadata:a,prefixedContent:o}=e,s=await f.ZP.createInvite(t,{target_type:ei.Iq.EMBEDDED_APPLICATION,target_application_id:n},i);await u.Z.ensurePrivateChannel(r).then(e=>{let t,n=M.Z.getChannel(e);if(null==n)throw Error(\"Private channel not found\");null!=o&&(t=w.ZP.parse(n,o).content),p.Z.sendInvite(e,s.code,i,a,t)})}"},{"code":"async function eE(e){let{activityChannelId:t,invitedChannelId:n,applicationId:r,location:i,inviteAnalyticsMetadata:a}=e,o=await f.ZP.createInvite(t,{target_type:ei.Iq.EMBEDDED_APPLICATION,target_application_id:r},i);null!=M.Z.getChannel(n)&&p.Z.sendInvite(n,o.code,i,a)}"},{"code":"function ev(e){l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_SET_PANEL_MODE\",activityPanelMode:e})}"},{"code":"function ey(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er.L.INDIRECT_ACTION;(0,S.wH)(s.z.ACTIVITIES_VOICE_LAUNCHER_BADGE,Math.floor(new Date().getTime()/1e3),{dismissAction:e})}"},{"code":"async function eg(e){var t,n,i,a;let{guildId:o,force:s=!1}=e,c=Y.ZP.getShelfActivities(o),u=c.map(e=>b.Z.getApplication(e.application_id)).filter(B.lm);if(!s&&!Y.ZP.shouldFetchShelf(o)){if(null==(t=Y.ZP.getShelfFetchStatus(o))?void 0:t.isFetching){let e,t,n=new Promise(t=>{e=em.bind(null,o,t),l.Z.subscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",e)}),r=new Promise(e=>{t=em.bind(null,o,e),l.Z.subscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",t)});await Promise.race([n,r]),null!=e&&(l.Z.unsubscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",e),e=null),null!=t&&(l.Z.unsubscribe(\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",t),t=null)}return{activityConfigs:c,applications:u}}try{l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF\",guildId:o});let e=void 0!==o&&\"\"!==o?{guild_id:o}:void 0,t=await V.Z.get({url:et.ANM.ACTIVITY_SHELF,query:e,trackedActionData:{event:r.NetworkActionNames.EMBEDDED_ACTIVITIES_FETCH_SHELF,properties:{guild_id:o}},retries:0,oldFormErrors:!0,rejectWithError:!0}),s=null!=(n=t.body.activities)?n:[],c=null!=(i=t.body.applications)?i:[],u=null!=(a=t.body.assets)?a:{};return l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF_SUCCESS\",guildId:o,activities:s,applications:c,assets:u}),c.length>0&&l.Z.dispatch({type:\"APPLICATIONS_FETCH_SUCCESS\",applications:c}),{activityConfigs:s,applications:c.map(e=>L.ZP.createFromServer(e))}}catch(e){return l.Z.dispatch({type:\"EMBEDDED_ACTIVITY_FETCH_SHELF_FAIL\",guildId:o}),{activityConfigs:c,applications:u}}}"}]