[{"code":"(e,t)=>{let n=r.useRef(0),[i,o]=r.useState(!1),[d,f]=r.useState({}),p=r.useRef(new AbortController),[_,h]=r.useState(t),m=r.useRef(new Map),g=r.useRef(new Map),E=r.useRef(null==e?void 0:e.skuId);return r.useEffect(()=>{t&&!_&&h(!0)},[t,_]),r.useEffect(()=>{if((null==e?void 0:e.skuId)!==E.current){var r;E.current=null==e?void 0:e.skuId,h(t);let i=null!=(r=null==e?void 0:e.config.effects.every(e=>{let{src:t}=e;return g.current.has(t)}))&&r;if(o(i),n.current=0,!i&&null!=e)for(let{src:t}of e.config.effects)m.current.has(t)||m.current.set(t,0)}},[e,t]),r.useEffect(()=>{if(null==e||0===e.config.effects.length||!1===_||0!==n.current)return;n.current=1;let t=p.current;e.config.effects.forEach(async e=>{if(g.current.has(e.src))m.current.set(e.src,2),u(m.current)&&(o(!0),n.current=2);else try{let r=await l(e.src,t.signal);if(t.signal.aborted)return;m.current.set(e.src,2),g.current.set(e.src,r.src),f(t=>s(a({},t),{[e.src]:r})),u(m.current)&&(o(!0),n.current=2)}catch(e){}})},[e,_]),r.useEffect(()=>{let e=g.current,t=p.current;return()=>{Array.from(e.values()).forEach(c),t.abort()}},[]),{loaded:i,layerData:d}}"}]