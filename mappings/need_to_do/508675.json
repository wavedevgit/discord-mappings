[{"code":"class em{static get(e){return void 0===e&&(e=null),(null==em._lastInstance||em._lastInstance.guildId!==e)&&(em._lastInstance=new em(e)),em._lastInstance}static reset(){em._lastInstance=null}static resetFrequentlyUsed(){null!=em._lastInstance&&(em._lastInstance.frequentlyUsed=null)}static resetFrequentlyUsedReactionEmojis(){null!=em._lastInstance&&(em._lastInstance.frequentlyUsedReactionEmojis=null,em._lastInstance.frequentlyUsedReactionNamesAndIds=null)}static clear(e){null!=em._lastInstance&&em._lastInstance.guildId===e&&(em._lastInstance=null)}getDisambiguatedEmoji(){return this.disambiguatedEmoji}getCustomEmoji(){return this.customEmojis}getGroupedCustomEmoji(){return this.groupedCustomEmojis}getByName(e){if(Object.prototype.hasOwnProperty.call(this.emojisByName,e))return this.emojisByName[e];if(Object.prototype.hasOwnProperty.call(this.unicodeAliases,e)){let t=this.unicodeAliases[e];if(Object.prototype.hasOwnProperty.call(this.emojisByName,t))return this.emojisByName[t]}}getEmoticonByName(e){if(Object.prototype.hasOwnProperty.call(this.emoticonsByName,e))return this.emoticonsByName[e]}getById(e){if(Object.prototype.hasOwnProperty.call(this.emojisById,e))return this.emojisById[e]}getCustomEmoticonRegex(){return null==this.emoticonRegex&&null!=this.escapedEmoticonNames&&\"\"!==this.escapedEmoticonNames&&(this.emoticonRegex=new RegExp(\"^\\\\b(\".concat(this.escapedEmoticonNames,\")\\\\b\"))),this.emoticonRegex}getFrequentlyUsedEmojisWithoutFetchingLatest(){if(null!=this.frequentlyUsed)return this.frequentlyUsed;let e=eg.frequently.map(e=>null!=e.id?this.getById(e.id):G.Ay.getByName(e.name)).filter(L.Vq),t=(0,F.A)(e);return this.frequentlyUsed=[...t.values()],this.frequentlyUsed}rebuildFrequentlyUsedReactionsEmojisWithoutFetchingLatest(){if(null!=this.frequentlyUsedReactionEmojis&&null!=this.frequentlyUsedReactionNamesAndIds)return{frequentlyUsedReactionEmojis:this.frequentlyUsedReactionEmojis,frequentlyUsedReactionNamesAndIds:this.frequentlyUsedReactionNamesAndIds};let e=eE.frequently.map(e=>null!=e.id?this.getById(e.id):G.Ay.getByName(e.name)).filter(L.Vq),t=(0,F.A)(e);return this.frequentlyUsedReactionEmojis=[...t.values()],this.frequentlyUsedReactionNamesAndIds=new Set(t.keys()),{frequentlyUsedReactionEmojis:this.frequentlyUsedReactionEmojis,frequentlyUsedReactionNamesAndIds:this.frequentlyUsedReactionNamesAndIds}}getFrequentlyUsedReactionEmojisWithoutFetchingLatest(){return this.rebuildFrequentlyUsedReactionsEmojisWithoutFetchingLatest().frequentlyUsedReactionEmojis}isFrequentlyUsedReactionEmojiWithoutFetchingLatest(e){var t;let{frequentlyUsedReactionNamesAndIds:n}=this.rebuildFrequentlyUsedReactionsEmojisWithoutFetchingLatest();if(null!=e.id)return n.has(e.id);let r=null!=(t=G.Ay.convertSurrogateToBase(e.surrogates))?t:e;return n.has(r.name)}rebuildFavoriteEmojisWithoutFetchingLatest(){var e,t;if(null!=this.favorites&&null!=this.favoriteNamesAndIds)return{favorites:this.favorites,favoriteNamesAndIds:this.favoriteNamesAndIds};let n=(null!=(e=null==(t=I.A.frecencyWithoutFetchingLatest.favoriteEmojis)?void 0:t.emojis)?e:[]).map(e=>{var t;return null!=(t=this.getById(e))?t:G.Ay.getByName(e)}).filter(L.Vq),r=(0,F.A)(n);return this.favorites=[...r.values()],this.favoriteNamesAndIds=new Set(r.keys()),{favorites:this.favorites,favoriteNamesAndIds:this.favoriteNamesAndIds}}get favoriteEmojisWithoutFetchingLatest(){return this.rebuildFavoriteEmojisWithoutFetchingLatest().favorites}getEmojiInPriorityOrderWithoutFetchingLatest(){let e=this.getFrequentlyUsedReactionEmojisWithoutFetchingLatest(),t=new Set;return this.favoriteEmojisWithoutFetchingLatest.concat(e).filter(e=>!t.has(e)&&(t.add(e),!0))}getTopEmojiWithoutFetchingLatest(e){if(null==this.topEmojis){var t;let n=es.get(e),r=V.A.getTopEmojiIdsByGuildId(e);if(null==n&&null==r)return et;let i=(null!=(t=null==n?void 0:n.emojiIds)?t:r).map(e=>{var t;return null!=(t=this.getById(e))?t:G.Ay.getByName(G.Ay.convertSurrogateToName(e,!1))}),a=[];i.forEach(e=>{null!=e&&a.push(e)});let o=this.getNewlyAddedEmojiForGuild(e).map(e=>e.id);this.topEmojis=a.filter(e=>!o.includes(e.id))}return this.topEmojis}getNewlyAddedEmojiForGuild(e){if(null==this.newlyAddedEmoji)return et;let t=this.newlyAddedEmoji[e];return null==t?et:t}getEscapedCustomEmoticonNames(){return this.escapedEmoticonNames}nameMatchesChain(e){return s()(this.getDisambiguatedEmoji()).filter(t=>{let{names:n,name:r}=t,i=null!=n&&s().some(n,e),a=null!=r&&e(r),o=null!=r&&s().some(g.A.getTermsForEmoji(r),e);return i||a||o})}constructor(e){K(this,\"favorites\",null),K(this,\"favoriteNamesAndIds\",null),K(this,\"topEmojis\",null),K(this,\"guildId\",void 0),K(this,\"escapedEmoticonNames\",void 0),K(this,\"disambiguatedEmoji\",[]),K(this,\"emoticonRegex\",null),K(this,\"frequentlyUsed\",null),K(this,\"frequentlyUsedReactionEmojis\",null),K(this,\"frequentlyUsedReactionNamesAndIds\",null),K(this,\"unicodeAliases\",{}),K(this,\"customEmojis\",{}),K(this,\"groupedCustomEmojis\",{}),K(this,\"emoticonsByName\",{}),K(this,\"emojisByName\",{}),K(this,\"emojisById\",{}),K(this,\"newlyAddedEmoji\",{}),K(this,\"isFavoriteEmojiWithoutFetchingLatest\",e=>{var t;if(null==e)return!1;let{favoriteNamesAndIds:n}=this.rebuildFavoriteEmojisWithoutFetchingLatest();if(null!=e.id)return n.has(e.id);let r=null!=(t=G.Ay.convertSurrogateToBase(e.surrogates))?t:e;return n.has(r.name)}),this.guildId=e;const t={},n=[],r=e=>{var n;e.names.slice(1).forEach(t=>this.unicodeAliases[t]=e.name);let r=null!=(n=t[e.name])?n:0;a()(0===r,\"Expected existing count to be 0\"),t[e.name]=r+1,this.emojisByName[e.name]=e,this.disambiguatedEmoji.push(e)},i=e=>{var n;let r,i=e.name,a=null!=(n=t[i])?n:0;if(t[i]=a+1,a>0){let t=\"\".concat(i,\"~\").concat(a);r=Z(z({},e),{name:t,originalName:i})}else r=e;this.emojisByName[r.name]=r,this.emojisById[r.id]=r,this.customEmojis[r.name]=r;let{guildId:o}=e;null!=this.groupedCustomEmojis[o]?this.groupedCustomEmojis[o].push(r):this.groupedCustomEmojis[o]=[r],M.default.compare(e.id,ee)>=0&&(null!=this.newlyAddedEmoji[o]?this.newlyAddedEmoji[o].push(r):this.newlyAddedEmoji[o]=[r]),this.disambiguatedEmoji.push(r)},o=e=>{Object.prototype.hasOwnProperty.call(this.emoticonsByName,e.name)||(n.push(x.A.escape(e.name)),this.emoticonsByName[e.name]=e)};G.Ay.forEach(r);const l=e=>{let t=ea[null==e?H.eGj:e];null!=t&&(s().each(t.usableEmojis,i),s().each(t.emoticons,o))};for(const e in l(this.guildId),this.newlyAddedEmoji)null!=this.newlyAddedEmoji[e]?this.newlyAddedEmoji[e]=this.newlyAddedEmoji[e].sort((e,t)=>M.default.compare(t.id,e.id)).slice(0,3):this.newlyAddedEmoji[e]=[];w.Ay.getFlattenedGuildIds().forEach(e=>{e!==this.guildId&&l(e)}),this.escapedEmoticonNames=n.join(\"|\")}}"}]