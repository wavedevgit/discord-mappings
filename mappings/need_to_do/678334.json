[{"code":"function w(e){let{premiumSubscription:t,setPurchaseState:n,onBack:a,onNext:s,legalTermsNodeRef:w,flashLegalTerms:R,invoiceError:D,planError:x,onPurchaseError:L,baseAnalyticsData:j,flowStartTime:M,trialId:k,planGroup:U,analyticsLocation:G,purchaseTokenAuthState:Z,openInvoiceId:F,metadata:B,backButtonEligible:V,disablePurchase:H,isTrial:Y=!1,onPaymentSourceAdd:W}=e,{selectedPlan:K,priceOptions:z,setHasAcceptedTerms:q,setPurchaseError:Q,purchaseType:X,paymentSourceId:J,paymentSources:$,selectedSkuId:ee,skusById:et,skuPricePreviewsById:en,referralCode:er,contextMetadata:ei,invoicePreview:ea,inReverseTrial:eo,premiumBrandRefreshBackgroundClassName:es}=(0,v.JL)(),{isGift:el,selectedGiftStyle:ec,customGiftMessage:eu,emojiConfetti:ed,soundEffect:ef,giftRecipient:ep,selectedGiftingPromotionReward:e_}=(0,O.wD)(),eh=(0,p.a5)(K),em=(0,b.MY)(ep),eg={};eg.gift_style=ec,eg.reward_sku_ids=eh&&(null==e_?void 0:e_.skuId)!=null?[null==e_?void 0:e_.skuId]:[],em===b.xr.CUSTOM_MESSAGE_EMOJI_SOUNDBOARD&&(l()(null!=ep,\"Gift recipient must be set at purchase review step for these gift options.\"),eg.recipient_id=ep.id,eg.custom_message=eu,eg.emoji_id=null==ed?void 0:ed.id,eg.emoji_name=(null==ed?void 0:ed.id)==null?null==ed?void 0:ed.surrogates:void 0,eg.sound_id=null==ef?void 0:ef.soundId);let eE=null==K?void 0:K.id,eb=(0,I.sE)(k,z.paymentSourceId,eE),{analyticsLocations:ey}=(0,d.ZP)(),eO=(0,C.m)($,J),[ev,eS]=i.useState(eb),[eI,eT]=i.useState(!1),{hasEntitlements:eC}=(0,m.H)(eE,el),eA=(0,y.Ap)(z.paymentSourceId),eN=eC||eb,eP=(0,_.U)(),ew=(0,c.e7)([T.Z],()=>T.Z.currentOrderId),eR=null,eD=null;if(X===N.GZQ.ONE_TIME){var ex;l()(null!=ee,\"SKU must be selected for one-time purchases\"),eR=null!=(ex=et[ee])?ex:null,l()(null!=eR,\"SKU must exist and be fetched.\");let e=en[ee],t=null!=J?J:E.c;eD=null!=e?e[t]:null}let eL=async()=>{await (0,S.H)({setPurchaseState:n,setHasAcceptedTerms:q,setIsSubmitting:eS,setPurchaseError:Q,hasRedirectURL:eI,setHasRedirectURL:eT,isGift:el,baseAnalyticsData:j,analyticsLocation:G,analyticsLocations:ey,flowStartTime:M,subscriptionPlan:K,planGroup:U,trialId:k,priceOptions:z,paymentSource:eO,isPrepaidPaymentPastDue:eP,openInvoiceId:F,premiumSubscription:t,onNext:s,metadata:B,sku:eR,skuPricePreview:eD,purchaseType:X,referralCode:er,loadId:ei.loadId,giftInfoOptions:eg,invoicePreview:ea,orderId:ew})},ej={baseAnalyticsData:j,flowStartTime:M,makePurchase:eL,onNext:s,onPurchaseError:L,paymentSource:eO,paymentSourceId:J,purchaseTokenAuthState:Z,setPurchaseState:n},eM=i.useRef(ej);i.useEffect(()=>{eM.current=ej}),i.useEffect(()=>{let{makePurchase:e}=eM.current;eb&&!el&&null==t&&e()},[eb,el,t]);let ek=null!=F||X===N.GZQ.ONE_TIME&&!el,eU=V&&!ek;return eb?null:(0,r.jsxs)(u.mzw,{\"data-migration-pending\":!0,align:f.Z.Align.CENTER,className:o()(es,P.modalFooter),children:[(0,r.jsx)(g.Z,{legalTermsNodeRef:w,invoiceError:D,planError:x,disablePurchase:H,flashLegalTerms:R,isSubmitting:ev,premiumSubscription:t,isGift:el,planGroup:U,isPrepaid:eA,isTrial:Y,makePurchase:eL,needsPaymentSource:null==eO&&!eN,onNext:s,inReverseTrial:eo,onPaymentSourceAdd:W}),(0,r.jsx)(A.Z,{}),eU?(0,r.jsx)(\"div\",{className:P.back,children:(0,r.jsx)(h.Z,{onClick:a})}):null]})}"}]